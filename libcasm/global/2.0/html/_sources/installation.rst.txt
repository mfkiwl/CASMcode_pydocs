Installation
============

.. note::

    CASM is available for macOS and Linux


Install from PyPI
-----------------

The latest release of libcasm-global can be installed with:

    pip install libcasm-global


Install from source
-------------------

Installation of libcasm distribution packages from source requires standard compilers with support for C++17, Python >= 3.8, and CMake. The use of `ccache <https://ccache.dev/>`_ is recommended to avoid duplicating compilations. These tools can be installed if not already present. For example:

- On Ubuntu linux:

  .. code-block::

      sudo apt-get install build-essential ccache cmake


- On Mac OSX:

  .. code-block::

      xcode-select --install
      brew install ccache cmake

- In a conda environment:

  .. code-block::

      conda create -n casm --override-channels -c conda-forge python=3 ccache cmake cxx-compiler
      conda activate casm

Clone libcasm-global from GitHub_:

.. code-block::

    git clone https://github.com/prisms-center/CASMcode_global.git
    cd CASMcode_global

Make sure submodules are checkout out with:

.. code-block::

    git submodule update --init --recursive


Then libcasm-global can be installed with:

.. attention::

    Care must be taken on linux that code linking to the CASM C++ libraries is compiled with the same choice of the ``-D_GLIBCXX_USE_CXX11_ABI`` compiler flag, otherwise there will be "undefined reference" linking errors (see `Dual ABI <https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html>`_).  The CASM Linux C++ libraries distributed on PyPI with tag ``"manylinux2014"`` use ``-D_GLIBCXX_USE_CXX11_ABI=0``. Newer compilers default to ``-D_GLIBCXX_USE_CXX11_ABI=1``.


.. code-block::

    # Configuration options:
    #
    # For compatibility with manylinux2014 packages set:
    #   export SKBUILD_CONFIGURE_OPTIONS="-DCMAKE_CXX_FLAGS='-D_GLIBCXX_USE_CXX11_ABI=0'"
    # To print compiler commands set:
    #   export SKBUILD_BUILD_OPTIONS="--verbose"
    pip install .


For Contributors
----------------

See the `libcasm contribution guide`_.


.. _`libcasm  contribution guide`: https://prisms-center.github.io/CASMcode_docs/pages/contributing_to_libcasm/
.. _CASM: https://prisms-center.github.io/CASMcode_docs/
